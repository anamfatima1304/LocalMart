{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Administrator\\\\Desktop\\\\Semester 6\\\\WAD\\\\Project\\\\Task\\\\my-app\\\\frontend\\\\src\\\\utils\\\\auth.js\";\n// src/utils/auth.js\nimport authService from '../services/authService';\n\n// Higher-order component for protecting routes\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const withAuth = WrappedComponent => {\n  return function AuthenticatedComponent(props) {\n    const isAuthenticated = authService.isAuthenticated();\n    if (!isAuthenticated) {\n      window.location.href = '/login';\n      return null;\n    }\n    return /*#__PURE__*/_jsxDEV(WrappedComponent, {\n      ...props\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 14,\n      columnNumber: 12\n    }, this);\n  };\n};\n\n// Higher-order component for seller-only routes\nexport const withSellerAuth = WrappedComponent => {\n  return function SellerAuthenticatedComponent(props) {\n    const isAuthenticated = authService.isAuthenticated();\n    const isSeller = authService.isSeller();\n    if (!isAuthenticated) {\n      window.location.href = '/login';\n      return null;\n    }\n    if (!isSeller) {\n      window.location.href = '/buyer-dashboard';\n      return null;\n    }\n    return /*#__PURE__*/_jsxDEV(WrappedComponent, {\n      ...props\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 34,\n      columnNumber: 12\n    }, this);\n  };\n};\n\n// Higher-order component for buyer-only routes\nexport const withBuyerAuth = WrappedComponent => {\n  return function BuyerAuthenticatedComponent(props) {\n    const isAuthenticated = authService.isAuthenticated();\n    const isBuyer = authService.isBuyer();\n    if (!isAuthenticated) {\n      window.location.href = '/login';\n      return null;\n    }\n    if (!isBuyer) {\n      window.location.href = '/seller-dashboard';\n      return null;\n    }\n    return /*#__PURE__*/_jsxDEV(WrappedComponent, {\n      ...props\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 12\n    }, this);\n  };\n};\n\n// Utility function to redirect based on user type\nexport const redirectToDashboard = () => {\n  const userType = authService.getUserType();\n  if (userType === 'seller') {\n    window.location.href = '/seller-dashboard';\n  } else if (userType === 'buyer') {\n    window.location.href = '/buyer-dashboard';\n  } else {\n    window.location.href = '/login';\n  }\n};\n\n// Utility function to validate password strength\nexport const validatePassword = password => {\n  const minLength = 6;\n  const hasUpperCase = /[A-Z]/.test(password);\n  const hasLowerCase = /[a-z]/.test(password);\n  const hasNumbers = /\\d/.test(password);\n  const errors = [];\n  if (password.length < minLength) {\n    errors.push(`Password must be at least ${minLength} characters long`);\n  }\n  if (!hasUpperCase) {\n    errors.push('Password must contain at least one uppercase letter');\n  }\n  if (!hasLowerCase) {\n    errors.push('Password must contain at least one lowercase letter');\n  }\n  if (!hasNumbers) {\n    errors.push('Password must contain at least one number');\n  }\n  return {\n    isValid: errors.length === 0,\n    errors\n  };\n};\n\n// Utility function to validate email\nexport const validateEmail = email => {\n  const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n  return emailRegex.test(email);\n};\n\n// Utility function to handle API errors\nexport const handleApiError = error => {\n  if (error.message) {\n    return error.message;\n  }\n  if (typeof error === 'string') {\n    return error;\n  }\n  return 'An unexpected error occurred. Please try again.';\n};","map":{"version":3,"names":["authService","jsxDEV","_jsxDEV","withAuth","WrappedComponent","AuthenticatedComponent","props","isAuthenticated","window","location","href","fileName","_jsxFileName","lineNumber","columnNumber","withSellerAuth","SellerAuthenticatedComponent","isSeller","withBuyerAuth","BuyerAuthenticatedComponent","isBuyer","redirectToDashboard","userType","getUserType","validatePassword","password","minLength","hasUpperCase","test","hasLowerCase","hasNumbers","errors","length","push","isValid","validateEmail","email","emailRegex","handleApiError","error","message"],"sources":["C:/Users/Administrator/Desktop/Semester 6/WAD/Project/Task/my-app/frontend/src/utils/auth.js"],"sourcesContent":["// src/utils/auth.js\r\nimport authService from '../services/authService';\r\n\r\n// Higher-order component for protecting routes\r\nexport const withAuth = (WrappedComponent) => {\r\n  return function AuthenticatedComponent(props) {\r\n    const isAuthenticated = authService.isAuthenticated();\r\n    \r\n    if (!isAuthenticated) {\r\n      window.location.href = '/login';\r\n      return null;\r\n    }\r\n    \r\n    return <WrappedComponent {...props} />;\r\n  };\r\n};\r\n\r\n// Higher-order component for seller-only routes\r\nexport const withSellerAuth = (WrappedComponent) => {\r\n  return function SellerAuthenticatedComponent(props) {\r\n    const isAuthenticated = authService.isAuthenticated();\r\n    const isSeller = authService.isSeller();\r\n    \r\n    if (!isAuthenticated) {\r\n      window.location.href = '/login';\r\n      return null;\r\n    }\r\n    \r\n    if (!isSeller) {\r\n      window.location.href = '/buyer-dashboard';\r\n      return null;\r\n    }\r\n    \r\n    return <WrappedComponent {...props} />;\r\n  };\r\n};\r\n\r\n// Higher-order component for buyer-only routes\r\nexport const withBuyerAuth = (WrappedComponent) => {\r\n  return function BuyerAuthenticatedComponent(props) {\r\n    const isAuthenticated = authService.isAuthenticated();\r\n    const isBuyer = authService.isBuyer();\r\n    \r\n    if (!isAuthenticated) {\r\n      window.location.href = '/login';\r\n      return null;\r\n    }\r\n    \r\n    if (!isBuyer) {\r\n      window.location.href = '/seller-dashboard';\r\n      return null;\r\n    }\r\n    \r\n    return <WrappedComponent {...props} />;\r\n  };\r\n};\r\n\r\n// Utility function to redirect based on user type\r\nexport const redirectToDashboard = () => {\r\n  const userType = authService.getUserType();\r\n  \r\n  if (userType === 'seller') {\r\n    window.location.href = '/seller-dashboard';\r\n  } else if (userType === 'buyer') {\r\n    window.location.href = '/buyer-dashboard';\r\n  } else {\r\n    window.location.href = '/login';\r\n  }\r\n};\r\n\r\n// Utility function to validate password strength\r\nexport const validatePassword = (password) => {\r\n  const minLength = 6;\r\n  const hasUpperCase = /[A-Z]/.test(password);\r\n  const hasLowerCase = /[a-z]/.test(password);\r\n  const hasNumbers = /\\d/.test(password);\r\n  \r\n  const errors = [];\r\n  \r\n  if (password.length < minLength) {\r\n    errors.push(`Password must be at least ${minLength} characters long`);\r\n  }\r\n  \r\n  if (!hasUpperCase) {\r\n    errors.push('Password must contain at least one uppercase letter');\r\n  }\r\n  \r\n  if (!hasLowerCase) {\r\n    errors.push('Password must contain at least one lowercase letter');\r\n  }\r\n  \r\n  if (!hasNumbers) {\r\n    errors.push('Password must contain at least one number');\r\n  }\r\n  \r\n  return {\r\n    isValid: errors.length === 0,\r\n    errors\r\n  };\r\n};\r\n\r\n// Utility function to validate email\r\nexport const validateEmail = (email) => {\r\n  const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\r\n  return emailRegex.test(email);\r\n};\r\n\r\n// Utility function to handle API errors\r\nexport const handleApiError = (error) => {\r\n  if (error.message) {\r\n    return error.message;\r\n  }\r\n  \r\n  if (typeof error === 'string') {\r\n    return error;\r\n  }\r\n  \r\n  return 'An unexpected error occurred. Please try again.';\r\n};\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}